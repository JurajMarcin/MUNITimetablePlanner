<button *ngIf="unsavedChanges" class="save-btn" (click)="saveTimetable()">Save changes</button>
<div *ngIf="timetable" class="settings">
  <label class="check-input">
    <input type="checkbox" (change)="toggleHiddenLessons($event.target.checked)">
    <span class="checkmark"></span>
    Show hidden lessons
  </label>
  <label class="check-input">
    <input type="checkbox" [checked]="compactMode" (change)="toggleCompactMode()">
    <span class="checkmark"></span>
    Compact mode
  </label>
</div>
<table *ngIf="displayTimetable">
  <thead>
    <tr>
      <td></td>
      <th *ngFor="let hour of displayTimetable.hours">
        {{hour.from | shortTime}} - {{hour.to | shortTime}}
      </th>
    </tr>
  </thead>
  <tbody>
    <ng-container *ngFor="let day of displayTimetable.days">
      <tr *ngFor="let line of day.lines">
        <th *ngIf="line.index === 0" [attr.rowSpan]="day.lines.length" class="day">{{dayNames[day.index]}}</th>
        <td *ngFor="let slot of line.slots" [attr.colSpan]="slot.span" [ngClass]="getSlotClasses(slot.lesson)">
          <app-lesson *ngIf="slot.lesson" [lesson]="slot.lesson" [compactMode]="compactMode"></app-lesson>
          <div class="hidden-overlay"></div>
          <app-lesson-edit *ngIf="slot.lesson" [lesson]="slot.lesson" (changed)="lessonChangedEvent()">
          </app-lesson-edit>
          <div *ngIf="slot.lesson && (slot.lesson.commentIds.length || compactMode)" class="comment">
            <app-lesson *ngIf="compactMode" [lesson]="slot.lesson"></app-lesson>
            <p *ngFor="let commentId of slot.lesson.commentIds">
              <span class="comment-id">{{commentId}}</span>
              <span [innerHTML]="getComment(commentId)"></span>
            </p>
          </div>
        </td>
      </tr>
    </ng-container>
  </tbody>
</table>
<div *ngIf="timetable" class="comments">
  <div *ngFor="let comment of timetable.comments" class="comment">
    <h2><sup>{{comment.id}}</sup></h2>
    <p [innerHTML]="comment.comment"></p>
  </div>
</div>
<div *ngIf="!displayTimetable">
  <h1>The timetable does not exist</h1>
</div>
